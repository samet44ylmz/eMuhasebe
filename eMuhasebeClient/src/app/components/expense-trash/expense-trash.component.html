<app-blank pageName="Gider Çöp Kutusu" [routes]="['Kayıtlar','Gider Çöp Kutusu']">
    <app-section sectionTitle="Silinen Giderler">
        <div class="form-group row">
            <div class="col-9">
                <!-- Removed "Seçilenleri Geri Yükle" button -->
                <button class="btn btn-danger" (click)="bulkDelete()" [disabled]="selectedExpenseIds.length === 0">
                    <i class="fa-solid fa-trash me-1"></i>
                    Seçilenleri Kalıcı Olarak Sil
                </button>
                <button class="btn btn-secondary ms-2" (click)="goBack()">
                    <i class="fa-solid fa-arrow-left me-1"></i>
                    Geri
                </button>
            </div>

            <div class="col-3">
                <input [(ngModel)]="search" type="search" class="form-control" placeholder="Aranacak değer girin...">
            </div>
        </div>

        <div class="form-group mt-2">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>
                            <input type="checkbox" [checked]="selectedExpenseIds.length === deletedExpenses.length && deletedExpenses.length > 0" 
                                   (change)="selectAll()">
                        </th>
                        <th>#</th>
                        <th>Gider Adı</th>
                        <th>Tarih</th>
                        <th>Kategori</th>
                        <th>Açıklama</th>
                        <th>Tutar</th>
                        <th>İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    @for(data of deletedExpenses | paginate: { itemsPerPage: 10, currentPage: p };track data){
                    <tr>
                        <td>
                            <input type="checkbox" [checked]="isSelected(data.id)" (change)="toggleSelection(data.id)">
                        </td>
                        <td>{{($index + 1)}}</td>
                        <td>{{data.name}}</td>
                        <td>{{data.date | date: 'dd.MM.yyyy'}}</td>
                        <td>{{data.categoryType.name}}</td>
                        <td>{{data.description}}</td>
                        <td>{{data.price | trCurrency: '₺': true}}</td>
                        <td class="d-flex">
                            <button (click)="restoreExpense(data)" class="btn btn-success btn-sm me-1" title="Geri Yükle">
                                <i class="fa-solid fa-rotate-left"></i>
                            </button>
                            <button (click)="permanentDeleteExpense(data)" class="btn btn-danger btn-sm" title="Kalıcı Olarak Sil">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                    }
                    @if (deletedExpenses.length === 0) {
                    <tr>
                        <td colspan="8" class="text-center text-muted">Çöp kutusu boş</td>
                    </tr>
                    }
                </tbody>
            </table>
            <div class="text-center">
                <pagination-controls nextLabel="Sonraki" previousLabel="Önceki" (pageChange)="p = $event"></pagination-controls>
            </div>
        </div>
    </app-section>
</app-blank>