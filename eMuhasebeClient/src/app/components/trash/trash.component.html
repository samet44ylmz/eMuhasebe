<app-blank pageName="Çöp Kutusu" [routes]="['Admin','Çöp Kutusu']">
    <app-section sectionTitle="Silinen Kullanıcılar">
        <div class="form-group row">
            <div class="col-9">
                <!-- Add back button -->
                <button class="btn btn-secondary me-2" (click)="goBack()">
                    <i class="fa-solid fa-arrow-left me-1"></i>
                    Geri
                </button>
                <!-- Removed "Seçilenleri Geri Yükle" button -->
                <button class="btn btn-danger" (click)="bulkDelete()" [disabled]="selectedUserIds.length === 0">
                    <i class="fa-solid fa-trash me-1"></i>
                    Seçilenleri Kalıcı Olarak Sil
                </button>
            </div>

            <div class="col-3">
                <input [(ngModel)]="search" type="search" class="form-control" placeholder="Aranacak değer girin...">
            </div>
        </div>

        <div class="form-group mt-2">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>
                            <input type="checkbox" [checked]="selectedUserIds.length === deletedUsers.length && deletedUsers.length > 0" 
                                   (change)="selectAll()">
                        </th>
                        <th>#</th>
                        <th>Ad Soyad</th>
                        <th>UserName</th>
                        <th>Mail Adresi</th>
                        <th>Admin Mi?</th>
                        <th>İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    @for(data of deletedUsers | user: search | paginate: { itemsPerPage: 10, currentPage: p };track data){
                    <tr>
                        <td>
                            <input type="checkbox" [checked]="isSelected(data.id)" (change)="toggleSelection(data.id)">
                        </td>
                        <td>{{($index + 1)}}</td>
                        <td>{{data.fullName}}</td>
                        <td>{{data.userName}}</td>
                        <td>{{data.email}}</td>
                        <td>
                            @if(data.isAdmin){
                            <span class="text-success">Evet</span>
                            }
                            @else {
                            <span class="text-danger">Hayır</span>
                            }
                        </td>
                        <td class="d-flex">
                            <button (click)="restoreUser(data)" class="btn btn-success btn-sm me-1" title="Geri Yükle">
                                <i class="fa-solid fa-rotate-left"></i>
                            </button>
                            <button (click)="permanentDeleteUser(data)" class="btn btn-danger btn-sm" title="Kalıcı Olarak Sil">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                    }
                    @if (deletedUsers.length === 0) {
                    <tr>
                        <td colspan="7" class="text-center text-muted">Çöp kutusu boş</td>
                    </tr>
                    }
                </tbody>
            </table>
            <div class="text-center">
                <pagination-controls nextLabel="Sonraki" previousLabel="Önceki" (pageChange)="p = $event"></pagination-controls>
            </div>
        </div>
    </app-section>
</app-blank>